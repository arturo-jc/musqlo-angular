<div class="card">
    <div class="flex">
        <div class="flex-1">
            <app-edit-in-place [(text)]="title"></app-edit-in-place>
        </div>
        <div class="flex align-items-center">
            <p-toggleButton
                offIcon="pi pi-arrows-alt"
                offLabel="Reorder"
                onIcon="pi pi-check"
                onLabel="Done"
                [style]="{ 'width': '8rem' }"
                [disabled]="!reorderMode && exerciseTemplates.length < 2"
                [(ngModel)]="reorderModeButtonPressed"
                (onChange)="toggleReorderMode()"
                ></p-toggleButton>
            <button 
                pButton
                pRipple
                type="button"
                icon="pi pi-save"
                label="Save"
                class="p-button p-button-success ml-2"
                [disabled]="!exerciseTemplates.length"
                (click)="saveWorkout()"
                ></button>
        </div>
    </div>
    <ul
        style="min-height: 30rem;"
        cdkDropList
        #templateList="cdkDropList"
        [cdkDropListData]="exerciseTemplates"
        (cdkDropListDropped)="drop($event)"
        (cdkDropListEntered)="overlay.hide()"
        class="exercise-templates"
        >
        <li *ngFor="let template of exerciseTemplates" [cdkDragData]="template" cdkDrag [cdkDragDisabled]="!reorderMode">
            <app-exercise-template
                [template]="template"
                [hideSets]="reorderModeButtonPressed"
                [reorderMode]="reorderMode"
                (onAddSet)="addSet($event)"
                (onDeleteTemplate)="deleteTemplate($event)"
                (onReorderSets)="reorderSets($event)"
                (onDeleteSet)="deleteSet($event)"
                ></app-exercise-template>
        </li>
        <li *ngIf="!exerciseTemplates.length" class="drop-here-outer">
            <i class="pi pi-inbox"></i>
            <div class="drop-here-inner">
                Drop exercises here to add them to your workout
            </div>
        </li>
    </ul>
</div>

<app-fixed-overlay (onShow)="exerciseItems.setFocus()" #overlay>
    <app-exercise-items
        #exerciseItems
        [cdkDroplistConnectedTo]="templateList"
        [placeholderSetsHidden]="reorderModeButtonPressed"
        ></app-exercise-items>
</app-fixed-overlay>
